<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Palpitar - Rodada</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: white;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .container {
            background: white;
            border-radius: 10px;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #4CAF50;
        }
        
        .titulo-rodada {
            color: #2C3E50;
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .subtitulo {
            color: #7F8C8D;
            font-size: 16px;
        }
        
        .status-info {
            background: #F8F9FA;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 25px;
            border-left: 4px solid #4CAF50;
        }
        
        .trunfo-status {
            font-weight: 600;
            margin-bottom: 8px;
            color: #2C3E50;
        }
        
        .pd-status {
            font-weight: 600;
            color: #2C3E50;
        }
        
        .pd-usada {
            color: #E74C3C;
        }
        
        .pd-disponivel {
            color: #27AE60;
        }
        
        .lista-jogos {
            margin-bottom: 30px;
        }
        
        .jogo {
            background: #F8F9FA;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid #E0E0E0;
        }
        
        .jogo-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .times {
            font-size: 18px;
            font-weight: 600;
            color: #2C3E50;
        }
        
        .pd-star {
            font-size: 24px;
            cursor: pointer;
            transition: transform 0.2s;
            color: #FFD700;
        }
        
        .pd-star:hover {
            transform: scale(1.2);
        }
        
        .pd-selected {
            color: #FFD700;
            text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
        }
        
        .pd-disabled {
            color: #BDC3C7;
            cursor: not-allowed;
        }
        
        .pd-ja-usada {
            color: #E74C3C;
            font-size: 14px;
            margin-top: 5px;
            font-style: italic;
        }
        
        .placar-inputs {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 10px;
        }
        
        .time-input {
            text-align: center;
        }
        
        .time-nome {
            font-size: 14px;
            color: #7F8C8D;
            margin-bottom: 5px;
        }
        
        .input-placar {
            width: 60px;
            height: 50px;
            font-size: 24px;
            text-align: center;
            border: 2px solid #3498DB;
            border-radius: 8px;
            outline: none;
        }
        
        .input-placar:focus {
            border-color: #2980B9;
            box-shadow: 0 0 5px rgba(52, 152, 219, 0.3);
        }
        
        .vs {
            font-size: 20px;
            font-weight: 600;
            color: #2C3E50;
        }
        
        .botoes-numeros {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        .btn-numero {
            width: 40px;
            height: 40px;
            border: 2px solid #3498DB;
            background: white;
            color: #3498DB;
            border-radius: 50%;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-numero:hover {
            background: #3498DB;
            color: white;
        }
        
        .btn-numero-selected {
            background: #3498DB;
            color: white;
        }
        
        .btn-acoes {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }
        
        .btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }
        
        .btn-enviar {
            background: #27AE60;
            color: white;
        }
        
        .btn-enviar:hover {
            background: #219653;
        }
        
        .btn-cancelar {
            background: #E74C3C;
            color: white;
        }
        
        .btn-cancelar:hover {
            background: #C0392B;
        }
        
        .instrucoes {
            margin-top: 25px;
            padding: 15px;
            background: #E8F4FC;
            border-radius: 8px;
            border-left: 4px solid #3498DB;
        }
        
        .instrucoes h3 {
            color: #2C3E50;
            margin-bottom: 10px;
        }
        
        .instrucoes ul {
            padding-left: 20px;
        }
        
        .instrucoes li {
            margin-bottom: 8px;
            color: #34495E;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #7F8C8D;
        }
        
        .erro {
            background: #FDEDED;
            color: #E74C3C;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #E74C3C;
            display: none;
        }
        
        .sucesso {
            background: #EDF7ED;
            color: #27AE60;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #27AE60;
            display: none;
        }
        
        .jogo-passado {
            opacity: 0.7;
            background: #F5F5F5;
        }
        
        .jogo-passado .times {
            color: #95A5A6;
        }
        
        @media (max-width: 600px) {
            body {
                padding: 10px;
            }
            
            .placar-inputs {
                gap: 10px;
            }
            
            .input-placar {
                width: 50px;
                height: 45px;
                font-size: 20px;
            }
            
            .btn-acoes {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="titulo-rodada">Rodada <span id="numero-rodada">0</span></h1>
            <p class="subtitulo">Preencha seus palpites abaixo</p>
        </div>
        
        <div class="status-info">
            <div class="trunfo-status" id="trunfo-status">‚è≥ Verificando trunfo...</div>
            <div class="pd-status" id="pd-status">‚è≥ Verificando pontua√ß√£o dobrada...</div>
            <div class="horario-limite" id="horario-limite">‚è≥ Carregando hor√°rio...</div>
        </div>
        
        <div class="erro" id="mensagem-erro"></div>
        <div class="sucesso" id="mensagem-sucesso"></div>
        
        <div class="lista-jogos" id="lista-jogos">
            <div class="loading">Carregando jogos...</div>
        </div>
        
        <div class="btn-acoes">
            <button class="btn btn-enviar" id="btn-enviar">‚úÖ Enviar Palpites</button>
            <button class="btn btn-cancelar" id="btn-cancelar">‚ùå Cancelar</button>
        </div>
        
        <div class="instrucoes">
            <h3>üìù Instru√ß√µes:</h3>
            <ul>
                <li>Selecione os placares usando os bot√µes ou digite diretamente</li>
                <li><span style="color: #FFD700; font-weight: bold;">‚≠ê Estrela</span> = Pontua√ß√£o Dobrada (apenas 1 por rodada)</li>
                <li>Se j√° usou a pontua√ß√£o dobrada, a estrela ficar√° desabilitada</li>
                <li>Voc√™ pode editar seus palpites at√© o hor√°rio limite</li>
                <li>‚ö†Ô∏è Jogos que j√° come√ßaram aparecem com opacidade reduzida</li>
            </ul>
        </div>
    </div>

    <script>
        // Par√¢metros da URL
        const urlParams = new URLSearchParams(window.location.search);
        const rodadaId = urlParams.get('rodada');
        const usuarioId = urlParams.get('usuario');
        const token = urlParams.get('token');
        
        // Estado da aplica√ß√£o
        let estado = {
            rodada: null,
            usuario: null,
            trunfo: false,
            pdDisponivel: false,
            pdJogoId: null, // ID do jogo onde usou PD (se j√° usou)
            pdJogoInfo: null, // Informa√ß√µes do jogo onde PD foi usada
            jogos: [],
            jogosFuturos: [],
            palpites: {},
            carregando: true,
            horarioLimite: null
        };
        
        // Elementos DOM
        const listaJogos = document.getElementById('lista-jogos');
        const trunfoStatus = document.getElementById('trunfo-status');
        const pdStatus = document.getElementById('pd-status');
        const horarioLimiteEl = document.getElementById('horario-limite');
        const btnEnviar = document.getElementById('btn-enviar');
        const btnCancelar = document.getElementById('btn-cancelar');
        const mensagemErro = document.getElementById('mensagem-erro');
        const mensagemSucesso = document.getElementById('mensagem-sucesso');
        
        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', async () => {
            if (!rodadaId || !usuarioId || !token) {
                mostrarErro('Par√¢metros inv√°lidos na URL');
                return;
            }
            
            await carregarDados();
            renderizarJogos();
        });
        
        // Fun√ß√£o para carregar dados da rodada
        async function carregarDados() {
            try {
                // Fazer requisi√ß√£o para API do bot
                const response = await fetch(`/api/palpites?rodada=${rodadaId}&usuario=${usuarioId}&token=${token}`);
                
                if (!response.ok) {
                    throw new Error('Erro ao carregar dados da rodada');
                }
                
                const data = await response.json();
                
                if (!data.sucesso) {
                    throw new Error(data.erro || 'Erro desconhecido');
                }
                
                // Preencher estado com dados do servidor
                estado.rodada = data.rodada;
                estado.usuario = data.usuario;
                estado.trunfo = data.trunfo;
                estado.pdDisponivel = data.pd_disponivel;
                estado.pdJogoId = data.pd_jogo_id;
                estado.pdJogoInfo = data.pd_jogo_info;
                estado.jogos = data.jogos;
                estado.jogosFuturos = data.jogos_futuros;
                estado.palpites = data.palpites || {};
                estado.horarioLimite = data.horario_limite;
                
                atualizarStatus();
                estado.carregando = false;
                
            } catch (error) {
                // Fallback para dados de simula√ß√£o
                console.warn('Usando dados simulados:', error.message);
                await carregarDadosSimulados();
            }
        }
        
        // Fallback: dados simulados
        async function carregarDadosSimulados() {
            try {
                // Simula√ß√£o: carrega dados da rodada
                estado.rodada = {
                    id: rodadaId,
                    numero: rodadaId,
                    horario_fechamento: '2024-12-25 20:00:00'
                };
                
                // Simula√ß√£o: verifica trunfo
                estado.trunfo = Math.random() > 0.5;
                
                // Simula√ß√£o: verifica PD dispon√≠vel
                estado.pdDisponivel = Math.random() > 0.3;
                
                // Simula√ß√£o: carrega jogos (com datas fict√≠cias)
                const agora = new Date();
                estado.jogos = [
                    { 
                        id: 1, 
                        mandante: 'Time A', 
                        visitante: 'Time B',
                        data_horario: new Date(agora.getTime() + 2*60*60*1000).toISOString(), // 2 horas no futuro
                        passado: false
                    },
                    { 
                        id: 2, 
                        mandante: 'Time C', 
                        visitante: 'Time D',
                        data_horario: new Date(agora.getTime() - 2*60*60*1000).toISOString(), // 2 horas no passado
                        passado: true
                    },
                    { 
                        id: 3, 
                        mandante: 'Time E', 
                        visitante: 'Time F',
                        data_horario: new Date(agora.getTime() + 4*60*60*1000).toISOString(), // 4 horas no futuro
                        passado: false
                    }
                ];
                
                // Filtrar jogos futuros
                estado.jogosFuturos = estado.jogos.filter(jogo => !jogo.passado);
                
                // Simula√ß√£o: carrega palpites anteriores (se existirem)
                estado.palpites = {
                    1: { mandante: 2, visitante: 1, pd: false },
                    2: { mandante: 0, visitante: 0, pd: true },
                    3: { mandante: 1, visitante: 1, pd: false }
                };
                
                // Verifica qual jogo tem PD
                for (const [jogoId, palpite] of Object.entries(estado.palpites)) {
                    if (palpite.pd) {
                        estado.pdJogoId = parseInt(jogoId);
                        estado.pdJogoInfo = estado.jogos.find(j => j.id === estado.pdJogoId);
                        break;
                    }
                }
                
                estado.horarioLimite = estado.rodada.horario_fechamento;
                
                atualizarStatus();
                estado.carregando = false;
                
            } catch (error) {
                mostrarErro('Erro ao carregar dados: ' + error.message);
            }
        }
        
        // Atualiza informa√ß√µes de status
        function atualizarStatus() {
            // Atualiza status do trunfo
            if (estado.trunfo) {
                trunfoStatus.innerHTML = '‚è∞ <strong>VOC√ä TEM TRUNFO</strong> - Tempo extra para palpitar';
            } else {
                trunfoStatus.innerHTML = '‚è∞ <strong>SEM TRUNFO</strong> - Hor√°rio normal';
            }
            
            // Atualiza status da PD
            if (estado.pdJogoId) {
                let pdInfo = '‚≠ê <strong>PONTUA√á√ÉO DOBRADA USADA</strong>';
                if (estado.pdJogoInfo) {
                    const timeFormatado = formatarData(estado.pdJogoInfo.data_horario);
                    pdInfo += ` no jogo ${estado.pdJogoInfo.mandante} x ${estado.pdJogoInfo.visitante} (${timeFormatado})`;
                }
                pdStatus.innerHTML = pdInfo;
                estado.pdDisponivel = false;
            } else if (estado.pdDisponivel) {
                pdStatus.innerHTML = '‚≠ê <strong>PONTUA√á√ÉO DOBRADA DISPON√çVEL</strong> (clique na estrela)';
            } else {
                pdStatus.innerHTML = '‚ùå <strong>SEM PONTUA√á√ÉO DOBRADA</strong> para esta rodada';
            }
            
            // Atualiza hor√°rio limite
            if (estado.horarioLimite) {
                const dataLimite = new Date(estado.horarioLimite);
                const formatado = formatarData(dataLimite);
                horarioLimiteEl.innerHTML = `üìÖ <strong>Fecha em:</strong> ${formatado}`;
                
                // Verifica se j√° passou do hor√°rio
                if (new Date() > dataLimite && !estado.trunfo) {
                    mostrarErro('‚ùå Hor√°rio limite expirado! Voc√™ n√£o pode mais palpitar.');
                    btnEnviar.disabled = true;
                    btnEnviar.style.opacity = '0.5';
                    btnEnviar.style.cursor = 'not-allowed';
                }
            }
            
            // Atualiza t√≠tulo
            document.getElementById('numero-rodada').textContent = estado.rodada.numero;
        }
        
        // Formatar data para exibi√ß√£o
        function formatarData(dataString) {
            const data = new Date(dataString);
            return data.toLocaleDateString('pt-BR', {
                day: '2-digit',
                month: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
        
        // Renderiza a lista de jogos (apenas futuros)
        function renderizarJogos() {
            if (estado.carregando) return;
            
            listaJogos.innerHTML = '';
            
            if (estado.jogosFuturos.length === 0) {
                listaJogos.innerHTML = '<div class="jogo"><p>N√£o h√° jogos futuros nesta rodada.</p></div>';
                return;
            }
            
            estado.jogosFuturos.forEach(jogo => {
                const jogoElement = document.createElement('div');
                jogoElement.className = `jogo ${jogo.passado ? 'jogo-passado' : ''}`;
                jogoElement.dataset.jogoId = jogo.id;
                
                const palpiteAtual = estado.palpites[jogo.id] || { mandante: '', visitante: '', pd: false };
                const temPD = estado.pdJogoId === jogo.id;
                const podeUsarPD = estado.pdDisponivel && !estado.pdJogoId && !jogo.passado;
                
                jogoElement.innerHTML = `
                    <div class="jogo-header">
                        <div class="times">${jogo.mandante} x ${jogo.visitante}</div>
                        <div class="pd-star ${temPD ? 'pd-selected' : ''} ${!podeUsarPD ? 'pd-disabled' : ''}" 
                             onclick="${podeUsarPD ? `selecionarPD(${jogo.id})` : 'return false;'}"
                             title="${temPD ? 'PD j√° utilizada neste jogo' : (podeUsarPD ? 'Clique para usar PD' : 'PD n√£o dispon√≠vel')}">
                            ${temPD ? '‚≠ê' : (podeUsarPD ? '‚òÜ' : '‚≠ê')}
                        </div>
                    </div>
                    
                    ${jogo.passado ? '<div class="pd-ja-usada">‚è∞ Jogo j√° iniciado</div>' : ''}
                    
                    <div class="placar-inputs">
                        <div class="time-input">
                            <div class="time-nome">${jogo.mandante}</div>
                            <input type="number" min="0" max="9" 
                                   class="input-placar mandante" 
                                   value="${palpiteAtual.mandante || ''}"
                                   onchange="atualizarPalpite(${jogo.id}, 'mandante', this.value)"
                                   placeholder="0"
                                   ${jogo.passado ? 'disabled' : ''}>
                        </div>
                        
                        <div class="vs">X</div>
                        
                        <div class="time-input">
                            <div class="time-nome">${jogo.visitante}</div>
                            <input type="number" min="0" max="9" 
                                   class="input-placar visitante" 
                                   value="${palpiteAtual.visitante || ''}"
                                   onchange="atualizarPalpite(${jogo.id}, 'visitante', this.value)"
                                   placeholder="0"
                                   ${jogo.passado ? 'disabled' : ''}>
                        </div>
                    </div>
                    
                    ${!jogo.passado ? `
                    <div class="botoes-numeros">
                        ${[0,1,2,3,4,5].map(num => `
                            <button class="btn-numero ${palpiteAtual.mandante == num ? 'btn-numero-selected' : ''}"
                                    onclick="selecionarPlacar(${jogo.id}, 'mandante', ${num})"
                                    ${jogo.passado ? 'disabled' : ''}>
                                ${num}
                            </button>
                        `).join('')}
                        
                        <div style="width: 20px;"></div>
                        
                        ${[0,1,2,3,4,5].map(num => `
                            <button class="btn-numero ${palpiteAtual.visitante == num ? 'btn-numero-selected' : ''}"
                                    onclick="selecionarPlacar(${jogo.id}, 'visitante', ${num})"
                                    ${jogo.passado ? 'disabled' : ''}>
                                ${num}
                            </button>
                        `).join('')}
                    </div>
                    ` : ''}
                `;
                
                listaJogos.appendChild(jogoElement);
            });
        }
        
        // Fun√ß√µes para manipular palpites
        window.selecionarPlacar = function(jogoId, tipo, valor) {
            const jogo = estado.jogos.find(j => j.id === jogoId);
            if (jogo && jogo.passado) return;
            
            // Remove sele√ß√£o anterior para este tipo
            const jogoElement = document.querySelector(`[data-jogo-id="${jogoId}"]`);
            const botoes = jogoElement.querySelectorAll(`.btn-numero`);
            botoes.forEach(btn => btn.classList.remove('btn-numero-selected'));
            
            // Adiciona sele√ß√£o ao bot√£o clicado
            const btnClicado = jogoElement.querySelector(`.btn-numero[onclick*="'${tipo}', ${valor}"]`);
            if (btnClicado) {
                btnClicado.classList.add('btn-numero-selected');
            }
            
            // Atualiza input
            const input = jogoElement.querySelector(`.input-placar.${tipo}`);
            input.value = valor;
            
            atualizarPalpite(jogoId, tipo, valor);
        };
        
        window.atualizarPalpite = function(jogoId, tipo, valor) {
            const jogo = estado.jogos.find(j => j.id === jogoId);
            if (jogo && jogo.passado) return;
            
            if (!estado.palpites[jogoId]) {
                estado.palpites[jogoId] = { mandante: '', visitante: '', pd: false };
            }
            
            estado.palpites[jogoId][tipo] = valor === '' ? '' : parseInt(valor);
            
            // Atualiza bot√£o selecionado
            if (valor !== '') {
                const jogoElement = document.querySelector(`[data-jogo-id="${jogoId}"]`);
                const botoes = jogoElement.querySelectorAll(`.btn-numero`);
                botoes.forEach(btn => btn.classList.remove('btn-numero-selected'));
                
                const btnParaSelecionar = jogoElement.querySelector(`.btn-numero[onclick*="'${tipo}', ${parseInt(valor)}"]`);
                if (btnParaSelecionar) {
                    btnParaSelecionar.classList.add('btn-numero-selected');
                }
            }
        };
        
        window.selecionarPD = function(jogoId) {
            if (!estado.pdDisponivel || estado.pdJogoId) return;
            
            // Remove PD anterior (se houver)
            if (estado.pdJogoId) {
                const estrelaAnterior = document.querySelector(`[data-jogo-id="${estado.pdJogoId}"] .pd-star`);
                if (estrelaAnterior) {
                    estrelaAnterior.classList.remove('pd-selected');
                    estado.palpites[estado.pdJogoId].pd = false;
                }
            }
            
            // Adiciona PD ao jogo selecionado
            estado.pdJogoId = jogoId;
            estado.palpites[jogoId].pd = true;
            
            const estrela = document.querySelector(`[data-jogo-id="${jogoId}"] .pd-star`);
            estrela.classList.add('pd-selected');
            estrela.innerHTML = '‚≠ê';
            
            // Desabilita PD em outros jogos
            document.querySelectorAll('.pd-star').forEach(star => {
                if (!star.classList.contains('pd-selected')) {
                    star.classList.add('pd-disabled');
                    star.onclick = null;
                    star.style.cursor = 'not-allowed';
                    star.innerHTML = '‚≠ê';
                }
            });
            
            estado.pdDisponivel = false;
            atualizarStatus();
        };
        
        // Enviar palpites
        btnEnviar.addEventListener('click', async () => {
            try {
                // Valida√ß√£o b√°sica
                for (const jogo of estado.jogosFuturos) {
                    const palpite = estado.palpites[jogo.id];
                    if (!palpite || palpite.mandante === '' || palpite.visitante === '') {
                        mostrarErro(`Preencha o placar completo para: ${jogo.mandante} x ${jogo.visitante}`);
                        return;
                    }
                }
                
                // Verifica hor√°rio limite
                if (estado.horarioLimite) {
                    const dataLimite = new Date(estado.horarioLimite);
                    if (new Date() > dataLimite && !estado.trunfo) {
                        mostrarErro('‚ùå Hor√°rio limite expirado! Voc√™ n√£o pode mais palpitar.');
                        return;
                    }
                }
                
                btnEnviar.disabled = true;
                btnEnviar.innerHTML = '‚è≥ Enviando...';
                
                // Envia dados para o bot
                const dados = {
                    tipo: 'enviar_palpites',
                    rodada_id: estado.rodada.id,
                    usuario_id: usuarioId,
                    token: token,
                    palpites: estado.palpites,
                    pd_jogo_id: estado.pdJogoId
                };
                
                console.log('Dados a enviar:', dados);
                
                // Envia para API do bot
                const response = await fetch('/api/enviar_palpites', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(dados)
                });
                
                const resultado = await response.json();
                
                if (resultado.sucesso) {
                    mostrarSucesso('‚úÖ Palpites enviados com sucesso!');
                    
                    // Fecha o Web App ap√≥s 2 segundos
                    setTimeout(() => {
                        if (window.Telegram && window.Telegram.WebApp) {
                            window.Telegram.WebApp.close();
                        } else {
                            // Fallback para navegador
                            alert('Palpites enviados com sucesso! Voc√™ pode fechar esta janela.');
                        }
                    }, 2000);
                    
                } else {
                    throw new Error(resultado.erro || 'Erro ao enviar palpites');
                }
                
            } catch (error) {
                mostrarErro('Erro ao enviar palpites: ' + error.message);
                btnEnviar.disabled = false;
                btnEnviar.innerHTML = '‚úÖ Enviar Palpites';
            }
        });
        
        // Cancelar
        btnCancelar.addEventListener('click', () => {
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.close();
            } else {
                mostrarErro('Feche a janela manualmente');
            }
        });
        
        // Fun√ß√µes auxiliares
        function mostrarErro(mensagem) {
            mensagemErro.textContent = mensagem;
            mensagemErro.style.display = 'block';
            mensagemSucesso.style.display = 'none';
        }
        
        function mostrarSucesso(mensagem) {
            mensagemSucesso.textContent = mensagem;
            mensagemSucesso.style.display = 'block';
            mensagemErro.style.display = 'none';
        }
        
        // Integra√ß√£o com Telegram Web App
        if (window.Telegram && window.Telegram.WebApp) {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand();
            Telegram.WebApp.enableClosingConfirmation();
        }
    </script>
</body>
</html>
