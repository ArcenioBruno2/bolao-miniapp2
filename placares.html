<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ“Š Editor de Resultados</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Estilos semelhantes ao placares_editor.html */
    </style>
</head>
<body>
    <div class="container">
        <div id="tela-principal">
            <div class="header">
                <h1><i class="fas fa-edit"></i> Editor da Rodada <span id="numero-rodada"></span></h1>
                <p>Preencha os resultados dos jogos abaixo.</p>
            </div>
            <div id="jogos-container"></div>
            <button class="btn btn-success" onclick="salvarResultados()">
                <i class="fas fa-save"></i> Salvar Resultados
            </button>
        </div>
        <!-- Telas de carregando e erro -->
    </div>

    <script>
        let TelegramWebApp = window.Telegram.WebApp;
        let rodadaData = {};

        document.addEventListener(\'DOMContentLoaded\', () => {
            TelegramWebApp.ready();
            TelegramWebApp.expand();
            
            try {
                const urlParams = new URLSearchParams(window.location.search);
                const dataParam = urlParams.get(\'data\');
                if (!dataParam) throw new Error(\'Dados da rodada nÃ£o encontrados.\');

                const dadosJson = atob(dataParam);
                rodadaData = JSON.parse(dadosJson);

                if (rodadaData.tipo !== \'dados_rodada\') throw new Error(\'Dados invÃ¡lidos.\');

                document.getElementById(\'numero-rodada\').textContent = rodadaData.rodada.numero;
                renderizarJogos();

            } catch (error) {
                // Mostrar erro
            }
        });

        function renderizarJogos() {
            const container = document.getElementById(\'jogos-container\');
            container.innerHTML = \'\';
            rodadaData.jogos.forEach(jogo => {
                // Renderiza cada jogo com inputs para gols
            });
        }

        function salvarResultados() {
            const resultados = {};
            rodadaData.jogos.forEach(jogo => {
                const golM = document.getElementById(`gol_m_${jogo.id}`).value;
                const golV = document.getElementById(`gol_v_${jogo.id}`).value;
                if (golM !== \'\' && golV !== \'\') {
                    resultados[jogo.id] = { gol_m: parseInt(golM), gol_v: parseInt(golV) };
                }
            });

            TelegramWebApp.sendData(JSON.stringify({
                tipo: \'salvar_resultados\',
                rodada_id: rodadaData.rodada.id,
                resultados: resultados
            }));
        }
    </script>
</body>
</html>
